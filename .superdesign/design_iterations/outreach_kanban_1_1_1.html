<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Outreach Board — Kanban (v1.1.1)</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

    <!-- Tailwind (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "ui-sans-serif", "system-ui", "-apple-system", "Segoe UI", "Roboto", "Helvetica Neue", "Arial", "Noto Sans", "Liberation Sans", "sans-serif"],
            },
            boxShadow: { card: "0 10px 30px -10px rgba(0,0,0,0.5)" },
          },
        },
      };
    </script>

    <!-- Flowbite (CDN) -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.5.1/flowbite.min.js"></script>

    <style>
      :root{
        /* App palette */
        --silver:#bfacaaff;
        --black:#02020aff;
        --oxford-blue:#05204aff;
        --wisteria:#b497d6ff;
        --lavender-web:#e1e2efff;
        --oxford-12: rgba(5,32,74,.12);
        --oxford-20: rgba(5,32,74,.20);
        --wisteria-12: rgba(180,151,214,.12);
        --wisteria-30: rgba(180,151,214,.30);
      }

      :root { color-scheme: dark; }
      html, body { height: 100%; }
      body {
        font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif !important;
        background:
          radial-gradient(900px 500px at 10% -10%, var(--oxford-12) 0%, transparent 60%),
          radial-gradient(900px 500px at 90% -10%, var(--wisteria-12) 0%, transparent 60%),
          linear-gradient(180deg, #0c0d14, #0a0b12 60%, #08090f 100%) !important;
        color: #ececf1 !important;
      }
      h1 { font-weight: 700 !important; letter-spacing: -0.02em !important; }
      .focus-ring:focus-visible { outline: 2px solid var(--lavender-web) !important; outline-offset: 2px !important; }

      /* Themed atoms */
      .navbar { background: linear-gradient(180deg, rgba(5,32,74,.75), rgba(12,13,20,.65)); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,.06); }
      .nav-link { color: #d4d6e1; border: 1px solid rgba(255,255,255,.06); }
      .nav-link:hover { color: #fff; border-color: rgba(255,255,255,.08); background: rgba(255,255,255,.03); }
      .nav-link[aria-current="page"] { color: #0f1018; background: var(--lavender-web); border-color: transparent; }
      .panel { border: 1px solid rgba(255,255,255,0.08); background: rgba(255,255,255,0.03); }
      .btn-primary { background: linear-gradient(90deg, var(--wisteria), var(--lavender-web)); color: #0f1018; font-weight: 700; }
      .btn-primary:hover { filter: brightness(1.06); }
      .btn-ghost { background: transparent; color: var(--lavender-web); border: 1px solid rgba(225,226,239,.30); }
      .btn-ghost:hover { background: rgba(225,226,239,.12); }
      .tag { border: 1px solid var(--wisteria-30); background: var(--wisteria-12); color: var(--lavender-web); }
      .brand-badge { background: var(--oxford-20); color: var(--lavender-web); border: 1px solid var(--oxford-blue); }
      .role-badge-founder { border: 1px solid rgba(225,226,239,.30); background: rgba(225,226,239,.12); color: var(--lavender-web); }

      /* Kanban */
      .kanban-board { display: grid; grid-template-columns: repeat(6, minmax(260px, 1fr)); gap: 12px; }
      .kanban-board.columns-4 { grid-template-columns: repeat(4, minmax(260px, 1fr)); }
      .kanban-col { border: 1px dashed rgba(255,255,255,.10); background: rgba(255,255,255,.02); }
      .kanban-col-header { border-bottom: 1px solid rgba(255,255,255,.06); background: linear-gradient(180deg, rgba(5,32,74,.3), rgba(12,13,20,.05)); }
      .kanban-card { background: rgba(255,255,255,.03); border: 1px solid rgba(255,255,255,.08); }
      .kanban-card.dragging { opacity: .6; }
      .drop-highlight { outline: 2px dashed var(--lavender-web) !important; outline-offset: -4px; }

      /* Stats */
      .stat-pill { border: 1px solid rgba(255,255,255,.08); background: rgba(255,255,255,.03); }
      .stat-dot { width:10px; height:10px; border-radius:9999px; display:inline-block; }

      /* Responsive */
      @media (max-width: 1024px) {
        .kanban-board, .kanban-board.columns-4 { grid-auto-flow: column; grid-template-columns: repeat(4, minmax(260px, 1fr)); overflow-x: auto; padding-bottom: 6px; }
      }
    </style>
  </head>
  <body class="min-h-screen">
    <!-- Navbar -->
    <nav class="navbar">
      <div class="mx-auto max-w-7xl px-4 py-3">
        <div class="flex items-center justify-between gap-3">
          <!-- Left: Brand -->
          <div class="flex items-center gap-2">
            <div class="h-7 w-7 shrink-0 rounded-full ring-2" style="--tw-ring-color: rgba(225,226,239,.30); background: conic-gradient(from 180deg at 50% 50%, var(--oxford-blue) 0%, var(--wisteria) 30%, var(--lavender-web) 70%, var(--oxford-blue) 100%); display:flex; align-items:center; justify-content:center; color: rgba(255,255,255,.95); font-weight: 800; font-size: 10px;">SF</div>
            <span class="text-sm font-semibold text-white">Startup Founders</span>
          </div>
          <!-- Center: Nav links -->
          <div class="hidden md:flex items-center gap-1">
            <a href="#" class="nav-link rounded-lg px-3 py-1.5 text-sm">Dashboard</a>
            <a href="#" class="nav-link rounded-lg px-3 py-1.5 text-sm">Opportunities</a>
            <a href="#" class="nav-link rounded-lg px-3 py-1.5 text-sm" aria-current="page">Outreach Board</a>
            <a href="#" class="nav-link rounded-lg px-3 py-1.5 text-sm">History</a>
          </div>
          <!-- Right: User (notification removed as requested) -->
          <div class="flex items-center gap-2 rounded-xl px-2 py-1.5 panel">
            <div class="h-7 w-7 shrink-0 rounded-full ring-2" style="--tw-ring-color: rgba(225,226,239,.30); background: conic-gradient(from 180deg at 50% 50%, var(--oxford-blue) 0%, var(--wisteria) 30%, var(--lavender-web) 70%, var(--oxford-blue) 100%); display:flex; align-items:center; justify-content:center; color: rgba(255,255,255,.95); font-weight: 800; font-size: 10px;">AC</div>
            <span class="hidden sm:inline text-sm font-medium text-white">Ava Chen</span>
            <svg viewBox="0 0 24 24" fill="#d1d2db" class="h-4 w-4 opacity-70"><path d="M7 10l5 5 5-5H7z"/></svg>
          </div>
        </div>

        <!-- Mobile nav links -->
        <div class="mt-3 grid grid-cols-2 gap-2 md:hidden">
          <a href="#" class="nav-link rounded-lg px-3 py-2 text-sm text-center">Dashboard</a>
          <a href="#" class="nav-link rounded-lg px-3 py-2 text-sm text-center">Opportunities</a>
          <a href="#" class="nav-link rounded-lg px-3 py-2 text-sm text-center" aria-current="page">Outreach Board</a>
          <a href="#" class="nav-link rounded-lg px-3 py-2 text-sm text-center">History</a>
        </div>
      </div>
    </nav>

    <!-- Page header -->
    <header class="mx-auto max-w-7xl px-4 pt-5 sm:pt-7">
      <div class="flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between">
        <div>
          <h1 class="text-lg sm:text-xl font-semibold text-white">Outreach Board</h1>
          <p class="text-sm text-[#ccceda]">Track the full life cycle of your conversations with founders across Email and LinkedIn.</p>
        </div>
      </div>
    </header>

    <!-- Tabs -->
    <div class="mx-auto max-w-7xl px-4 pt-4 sm:pt-6">
      <div role="tablist" aria-label="Outreach channels" class="inline-flex rounded-xl border border-white/10 panel p-1 text-sm">
        <button id="tab-email-btn" role="tab" aria-selected="true" aria-controls="tab-email" class="tab-btn focus-ring rounded-lg px-3 py-1.5 text-neutral-200">Email</button>
        <button id="tab-linkedin-btn" role="tab" aria-selected="false" aria-controls="tab-linkedin" class="tab-btn focus-ring rounded-lg px-3 py-1.5 text-neutral-200">LinkedIn</button>
      </div>
    </div>

    <!-- Stats Bar -->
    <div class="mx-auto max-w-7xl px-4 pt-4">
      <div id="statsBar" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2"></div>
    </div>

    <!-- Boards -->
    <main class="mx-auto max-w-7xl px-4 py-6 sm:py-8">
      <!-- Email Board -->
      <section id="tab-email" role="tabpanel" aria-labelledby="tab-email-btn">
        <div id="emailBoard" class="kanban-board" aria-live="polite"></div>
      </section>
      <!-- LinkedIn Board -->
      <section id="tab-linkedin" role="tabpanel" aria-labelledby="tab-linkedin-btn" class="hidden">
        <div id="linkedinBoard" class="kanban-board columns-4" aria-live="polite"></div>
      </section>
    </main>

    <!-- Message Modal -->
    <div id="messageModal" class="fixed inset-0 z-50 hidden items-center justify-center">
      <div class="absolute inset-0 bg-black/60" data-close-modal></div>
      <div class="relative z-10 w-[min(720px,92vw)] rounded-2xl panel p-4">
        <div class="flex items-start justify-between gap-3">
          <div class="flex items-center gap-2">
            <div id="m-avatar" class="h-10 w-10 shrink-0 rounded-xl brand-badge flex items-center justify-center font-semibold">AR</div>
            <div>
              <div id="m-name" class="text-base font-semibold text-white">Alex Rivera</div>
              <div class="mt-0.5 flex items-center gap-1 text-xs text-neutral-400">
                <span id="m-role">Founder</span>
                <span>•</span>
                <span id="m-channel">Email</span>
              </div>
            </div>
          </div>
          <div class="flex items-center gap-2">
            <span id="m-type" class="tag inline-flex items-center rounded-full px-2 py-0.5 text-[11px]">Job Inquiry</span>
            <button class="focus-ring rounded-lg px-2.5 py-1 text-xs font-semibold btn-primary" data-close-modal>Close</button>
          </div>
        </div>
        <div id="m-links" class="mt-2 flex items-center gap-2 text-xs">
          <a id="m-email" href="#" class="rounded-lg px-2 py-1 panel hover:bg-[#18192a] flex items-center gap-1">
            <svg viewBox="0 0 24 24" fill="#e8e9f1" class="h-3.5 w-3.5"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2Zm0 4-8 5L4 8V6l8 5 8-5v2Z"/></svg>
            <span id="m-email-text">alex@acme.ai</span>
          </a>
          <a id="m-linkedin" href="#" target="_blank" rel="noopener noreferrer" class="rounded-lg px-2 py-1 panel hover:bg-[#18192a] flex items-center gap-1">
            <svg viewBox="0 0 24 24" fill="#e8e9f1" class="h-3.5 w-3.5"><path d="M6 6a2 2 0 1 1 0-4 2 2 0 0 1 0 4ZM4 8h4v12H4V8Zm6 0h4v2.5c.6-1.1 2.1-2.5 4.7-2.5 5 0 5.3 3.3 5.3 7.6V20h-4v-5.3c0-2.1 0-4.7-2.9-4.7s-3.4 2.2-3.4 4.6V20h-4V8Z"/></svg>
            <span id="m-linkedin-text">linkedin.com/in/alex</span>
          </a>
        </div>
        <div class="mt-4 grid gap-2">
          <div id="m-subject" class="text-sm font-semibold text-white">Subject</div>
          <div id="m-body" class="rounded-xl panel p-3 text-[13px] leading-6 text-neutral-200 whitespace-pre-wrap"></div>
        </div>
      </div>
    </div>

    <script>
      // Stages
      const emailStages = ["Sent", "Responded", "In Talks", "Interviewing", "Rejected", "Hired"];
      const linkedinStages = ["Sent", "Responded", "Connected", "Ghosted"];

      // Seed demo data (with subjects)
      const seedData = [
        { id: 'c1', channel: 'email', stage: 'Sent', name: 'Alex Rivera', initials: 'AR', role: 'Founder', type: 'Job Inquiry', email: 'alex@acme.ai', linkedin: 'https://linkedin.com/in/alex', subject: 'Founding Engineer at Acme AI', message: 'Hi Alex — I admire Acme AI. I would love to discuss a founding engineer role focused on agents and infra. Quick intro below and links to my work…', history: [ { dt: '2025-08-01', by: 'You', text: 'Sent email: Job inquiry for founding engineer' } ] },
        { id: 'c2', channel: 'email', stage: 'Responded', name: 'Priya Shah', initials: 'PS', role: 'CTO', type: 'Collaboration', email: 'pshah@vector.dev', linkedin: 'https://linkedin.com/in/priya', subject: 'Design Partner Collaboration', message: 'Hi Priya — Loved your recent talk. We are building tooling for LLM evals and would love Vector as a design partner. Are you open to a 20-min chat this week?', history: [ { dt: '2025-08-02', by: 'You', text: 'Sent collab email re: design partners' }, { dt: '2025-08-03', by: 'Priya', text: 'Let’s talk this Thu' } ] },
        { id: 'c3', channel: 'linkedin', stage: 'Sent', name: 'Ben Lee', initials: 'BL', role: 'Founder', type: 'Friendship', email: '', linkedin: 'https://linkedin.com/in/ben', subject: 'Big fan of your work', message: 'Hey Ben — huge fan of your work on agents. Would love to connect and swap notes on evaluation and long-context strategies.', history: [ { dt: '2025-08-04', by: 'You', text: 'Sent LinkedIn msg: friendship / networking' } ] },
        { id: 'c4', channel: 'linkedin', stage: 'Connected', name: 'Mina Okafor', initials: 'MO', role: 'Head of Eng', type: 'Job Inquiry', email: 'mina@atlas.so', linkedin: 'https://linkedin.com/in/mina', subject: 'Thanks for connecting!', message: 'Appreciate the connection, Mina. Quick question about Atlas eng roles and the stack you are building. Would love to see if my background could be a fit.', history: [ { dt: '2025-08-05', by: 'You', text: 'Sent LI msg: job inquiry' }, { dt: '2025-08-06', by: 'Mina', text: 'Let’s connect. Here’s my email.' } ] },
      ];

      // State with guaranteed seed
      const state = (() => {
        try {
          const raw = JSON.parse(localStorage.getItem('kanban-demo-v2') || '[]');
          if (Array.isArray(raw) && raw.length > 0) return raw;
          localStorage.setItem('kanban-demo-v2', JSON.stringify(seedData));
          return [...seedData];
        } catch (e) {
          localStorage.setItem('kanban-demo-v2', JSON.stringify(seedData));
          return [...seedData];
        }
      })();

      // Helpers
      const $ = (sel, root=document) => root.querySelector(sel);
      const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
      const safeHostname = (url) => { try { return new URL(url).hostname + '/…'; } catch { return url || ''; } };
      const snippet = (t, n=120) => (t||'').length>n ? (t.slice(0,n-1)+'…') : (t||'');

      function stageColumns(stages, channel) {
        return stages.map(s => `
          <div class="kanban-col rounded-2xl" data-stage="${s}" data-channel="${channel}">
            <div class="kanban-col-header flex items-center justify-between rounded-t-2xl px-3 py-2">
              <div class="flex items-center gap-2">
                <span class="inline-flex h-5 w-5 items-center justify-center rounded-md brand-badge text-[11px] font-bold">${s[0]}</span>
                <span class="text-[13px] font-semibold text-white">${s}</span>
              </div>
              <span class="text-[11px] text-neutral-400"><span class="count">0</span></span>
            </div>
            <div class="p-2 grid gap-2 min-h-[100px]" ondragover="event.preventDefault()" ondragenter="onDragEnter(event)" ondragleave="onDragLeave(event)" ondrop="onDrop(event)"></div>
          </div>
        `).join('');
      }

      function renderBoards() {
        $('#emailBoard').innerHTML = stageColumns(emailStages, 'email');
        $('#linkedinBoard').innerHTML = stageColumns(linkedinStages, 'linkedin');
        state.forEach(item => placeCard(item));
        updateCounts();
        renderStats(currentTab);
      }

      function cardEl(item) {
        const el = document.createElement('article');
        el.className = 'kanban-card rounded-xl p-3 text-sm select-none';
        el.draggable = true;
        el.innerHTML = `
          <div class="flex items-start gap-2">
            <div class="card-initials flex h-9 w-9 items-center justify-center rounded-lg brand-badge">${item.initials}</div>
            <div class="min-w-0 flex-1">
              <div class="flex items-center justify-between gap-2">
                <h3 class="truncate text-[13px] font-semibold">${item.name}</h3>
                <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide role-badge-founder">${item.role}</span>
              </div>
              <div class="mt-1 flex flex-wrap items-center gap-1">
                <span class="tag inline-flex items-center rounded-full px-2 py-0.5 text-[11px]">${item.type}</span>
                <span class="text-[11px] text-neutral-400">• ${item.channel === 'email' ? 'Email' : 'LinkedIn'}</span>
              </div>
              <button class="mt-2 w-full text-left rounded-lg panel px-2 py-2 hover:bg-[#18192a]" data-message-for="${item.id}">
                <div class="truncate text-[12px] font-semibold text-white">${item.subject || 'Message'}</div>
                <div class="mt-0.5 line-clamp-2 text-[12px] text-neutral-300">${snippet(item.message, 140)}</div>
              </button>
              <div class="mt-2 flex items-center gap-1 text-[11px] text-neutral-400">
                ${item.email ? `<a href="mailto:${item.email}" class="rounded-lg px-2 py-1 panel hover:bg-[#18192a]" title="Email">Email</a>` : ''}
                ${item.linkedin ? `<a href="${item.linkedin}" target="_blank" rel="noopener noreferrer" class="rounded-lg px-2 py-1 panel hover:bg-[#18192a]" title="LinkedIn">LinkedIn</a>` : ''}
              </div>
            </div>
          </div>`;
        el.dataset.id = item.id;
        el.dataset.channel = item.channel;
        el.addEventListener('dragstart', onDragStart);
        el.addEventListener('dragend', onDragEnd);
        return el;
      }

      function placeCard(item) {
        const board = item.channel === 'email' ? $('#emailBoard') : $('#linkedinBoard');
        const col = board.querySelector(`.kanban-col[data-stage="${item.stage}"][data-channel="${item.channel}"] .p-2`);
        if (!col) return;
        col.appendChild(cardEl(item));
      }

      function updateCounts() {
        ['#emailBoard', '#linkedinBoard'].forEach(sel => {
          $$(sel + ' .kanban-col').forEach(col => {
            col.querySelector('.count').textContent = col.querySelectorAll('.kanban-card').length;
          });
        });
      }

      // Stats rendering
      function countByStage(channel){
        const stages = channel === 'email' ? emailStages : linkedinStages;
        const counts = Object.fromEntries(stages.map(s => [s, 0]));
        state.filter(x => x.channel === channel).forEach(x => counts[x.stage] = (counts[x.stage] || 0) + 1);
        return counts;
      }
      function colorFor(stage){
        // subtle dot color variations
        const map = {
          'Sent': 'bg-[#7f8bb3]', 'Responded': 'bg-[#b497d6]', 'In Talks': 'bg-[#c7a8e6]', 'Interviewing': 'bg-[#e1e2ef]', 'Rejected': 'bg-[#9b4444]', 'Hired': 'bg-[#62c98d]', 'Connected': 'bg-[#7fb3a6]', 'Ghosted': 'bg-[#8b7f7f]'
        };
        return map[stage] || 'bg-[#a6a7b4]';
      }
      function renderStats(channel){
        const stages = channel === 'email' ? emailStages : linkedinStages;
        const counts = countByStage(channel);
        const total = Object.values(counts).reduce((a,b)=>a+b,0);
        $('#statsBar').innerHTML = stages.map(s => `
          <div class="stat-pill rounded-xl px-3 py-2 flex items-center justify-between gap-2">
            <div class="flex items-center gap-2">
              <span class="stat-dot ${colorFor(s)}"></span>
              <span class="text-[12px] text-neutral-300">${s}</span>
            </div>
            <span class="text-[12px] font-semibold text-white">${counts[s] || 0}</span>
          </div>
        `).join('');
      }

      // Drag & Drop
      let dragId = null; let currentTab = 'email';
      function onDragStart(e){ dragId = this.dataset.id; this.classList.add('dragging'); }
      function onDragEnd(e){ this.classList.remove('dragging'); }
      window.onDragEnter = function(e){ e.currentTarget.classList.add('drop-highlight'); }
      window.onDragLeave = function(e){ e.currentTarget.classList.remove('drop-highlight'); }
      window.onDrop = function(e){
        e.preventDefault();
        const container = e.currentTarget; container.classList.remove('drop-highlight');
        const col = container.closest('.kanban-col');
        const stage = col.dataset.stage; const channel = col.dataset.channel;
        const card = document.querySelector(`.kanban-card[data-id="${dragId}"]`);
        const item = state.find(x => x.id === dragId);
        if (!card || !item) return;
        if (item.channel !== channel) return; // prevent cross-channel drops
        container.appendChild(card);
        item.stage = stage;
        localStorage.setItem('kanban-demo-v2', JSON.stringify(state));
        updateCounts();
        renderStats(currentTab);
      }

      // Tabs logic
      function selectTab(which){
        currentTab = which;
        const emailBtn = $('#tab-email-btn');
        const liBtn = $('#tab-linkedin-btn');
        const emailTab = $('#tab-email');
        const liTab = $('#tab-linkedin');
        const on = 'bg-[var(--lavender-web)] text-[#0f1018]';
        const off = 'bg-transparent text-neutral-200';
        if (which === 'email'){
          emailBtn.classList.add(...on.split(' ')); liBtn.classList.remove(...on.split(' '));
          liBtn.classList.add(...off.split(' ')); emailBtn.classList.remove(...off.split(' '));
          emailTab.classList.remove('hidden'); liTab.classList.add('hidden');
        } else {
          liBtn.classList.add(...on.split(' ')); emailBtn.classList.remove(...on.split(' '));
          emailBtn.classList.add(...off.split(' ')); liBtn.classList.remove(...off.split(' '));
          liTab.classList.remove('hidden'); emailTab.classList.add('hidden');
        }
        renderStats(which);
      }
      $('#tab-email-btn').addEventListener('click', () => selectTab('email'));
      $('#tab-linkedin-btn').addEventListener('click', () => selectTab('linkedin'));

      // Message modal
      function openMessage(item){
        $('#m-avatar').textContent = item.initials;
        $('#m-name').textContent = item.name;
        $('#m-role').textContent = item.role;
        $('#m-channel').textContent = item.channel === 'email' ? 'Email' : 'LinkedIn';
        $('#m-type').textContent = item.type;
        $('#m-subject').textContent = item.subject || 'Message';
        const emailA = $('#m-email'); const emailT = $('#m-email-text');
        if (item.email){ emailA.classList.remove('hidden'); emailA.href = 'mailto:' + item.email; emailT.textContent = item.email; } else { emailA.classList.add('hidden'); }
        const liA = $('#m-linkedin'); const liT = $('#m-linkedin-text');
        if (item.linkedin){ liA.classList.remove('hidden'); liA.href = item.linkedin; liT.textContent = safeHostname(item.linkedin); } else { liA.classList.add('hidden'); }
        $('#m-body').textContent = item.message || '';
        $('#messageModal').classList.remove('hidden');
        $('#messageModal').classList.add('flex');
      }
      function closeModal(){ const m = $('#messageModal'); m.classList.add('hidden'); m.classList.remove('flex'); }
      document.addEventListener('click', (e) => {
        if (e.target.matches('[data-close-modal]')) closeModal();
        const trg = e.target.closest('[data-message-for]');
        if (trg){ const id = trg.getAttribute('data-message-for'); const item = state.find(x => x.id === id); if (item) openMessage(item); }
      });

      // Initialize
      renderBoards();
      selectTab('email');
    </script>
  </body>
</html>
